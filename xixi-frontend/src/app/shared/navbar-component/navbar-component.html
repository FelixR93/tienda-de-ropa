<nav class="navbar">
  <div class="navbar-inner">
    <!-- LADO IZQUIERDO: LOGO + LINKS -->
    <div class="nav-left">
      <!-- Logo -->
      <a
        routerLink="/"
        class="logo"
        (click)="closeMenus()"
      >
        <span class="logo-mark">XI</span>
        <span class="logo-text">XI STORE</span>
      </a>

      <!-- Links principales (desktop) -->
      <div class="nav-main-links">
        <a
          routerLink="/"
          routerLinkActive="active"
          (click)="closeMenus()"
        >
          Inicio
        </a>

        <a
          routerLink="/products"
          routerLinkActive="active"
          (click)="closeMenus()"
        >
          Productos
        </a>

        <!-- Dropdown de categor칤as -->
        <div
          class="nav-dropdown"
          *ngIf="categories && categories.length > 0"
        >
          <button
            type="button"
            class="nav-dropdown-toggle"
            (click)="toggleCategories()"
            [class.open]="isCategoriesOpen"
          >
            Categor칤as
            <span class="chevron"></span>
          </button>

          <div
            class="nav-dropdown-menu"
            *ngIf="isCategoriesOpen"
          >
            <a
              *ngFor="let category of categories"
              [routerLink]="['/category', category._id]"
              (click)="closeMenus()"
            >
              {{ category.name }}
            </a>
          </div>
        </div>

        <!-- Link admin solo para ADMIN -->
        <a
          *ngIf="isAdmin()"
          routerLink="/admin"
          routerLinkActive="active"
          (click)="goToAdmin()"
        >
          Panel admin
        </a>
      </div>
    </div>

    <!-- LADO DERECHO: CARRITO + USUARIO + AUTH + MEN칔 MOBILE -->
    <div class="nav-right">
      <!-- Carrito -->
      <a
        routerLink="/cart"
        class="cart"
        (click)="closeMenus()"
      >
        <span class="cart-icon">游</span>
        <span class="cart-count" *ngIf="cartCount > 0">
          {{ cartCount }}
        </span>
      </a>

      <!-- Usuario logueado -->
      <div
        class="user"
        *ngIf="currentUser; else authLinks"
      >
        <div class="user-info">
          <span class="user-greeting">Hola,</span>
          <span class="user-name">{{ currentUser.name }}</span>
        </div>

        <a
          routerLink="/my-orders"
          class="btn-link secondary"
          (click)="closeMenus()"
        >
          Mis pedidos
        </a>

        <button
          type="button"
          class="btn-link danger"
          (click)="logout()"
        >
          Cerrar sesi칩n
        </button>
      </div>

      <!-- Invitado (no logueado) -->
      <ng-template #authLinks>
        <div class="auth-links">
          <a
            routerLink="/login"
            routerLinkActive="active"
            (click)="closeMenus()"
          >
            Iniciar sesi칩n
          </a>
          <a
            routerLink="/register"
            class="btn-primary"
            (click)="closeMenus()"
          >
            Registrarse
          </a>
        </div>
      </ng-template>

      <!-- Bot칩n hamburguesa (mobile) -->
      <button
        class="menu-toggle"
        type="button"
        (click)="toggleMenu()"
      >
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>

  <!-- Men칰 m칩vil (panel desplegable) -->
  <div
    class="mobile-menu"
    *ngIf="isMenuOpen"
  >
    <a
      routerLink="/"
      routerLinkActive="active"
      (click)="closeMenus()"
    >
      Inicio
    </a>

    <a
      routerLink="/products"
      routerLinkActive="active"
      (click)="closeMenus()"
    >
      Productos
    </a>

    <a
      *ngIf="isAdmin()"
      routerLink="/admin"
      routerLinkActive="active"
      (click)="goToAdmin()"
    >
      Panel admin
    </a>

    <!-- Categor칤as listadas en mobile -->
    <div
      class="mobile-categories"
      *ngIf="categories && categories.length > 0"
    >
      <div class="mobile-categories-label">
        Categor칤as
      </div>
      <a
        *ngFor="let category of categories"
        [routerLink]="['/category', category._id]"
        (click)="closeMenus()"
      >
        {{ category.name }}
      </a>
    </div>
  </div>
</nav>
